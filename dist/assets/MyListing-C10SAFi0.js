import{j as t,L as P,o as I,r as u}from"./index-Bm7eXvp5.js";import{m as D}from"./fakedb-CLG5xF5S.js";import{S as E}from"./Select-CzhLSy1V.js";import{I as $}from"./Input-BDyt2fuC.js";import{P as _}from"./ProductCard--HhOB_Nv.js";function q({property:e,landingPage:a,showAvailabilityToggle:i=!1,availabilityLabel:x,onToggleAvailability:o}){const c=e.isAvailable??!0,m=x??(c?"Visible to clients":"Hidden from clients"),f=O(e.media),y=f?.url??"",v=B(e.price),j=b(e.propertyType??""),l=b(e.propertyCategory??e.categoryType??"Uncategorized"),n=b(e.propertySubType??e.categoryType??""),N=R(e);return t.jsxs(P,{to:a?`/property-view/${e.id}`:`/dashboard/property-view/${e.id}`,className:"group relative bg-white rounded-xl border border-[#CCE3FD] overflow-hidden shadow-sm transition-all duration-300 ease-out hover:-translate-y-1 focus-visible:ring-2 focus-visible:ring-primary/40 block",children:[t.jsx("button",{"aria-label":"Add to favourites",onClick:p=>{p.preventDefault(),p.stopPropagation()},className:"absolute top-3 right-3 z-10 w-9 h-9 bg-white/70 backdrop-blur-sm rounded-full flex items-center justify-center shadow-sm transition-transform duration-150 hover:scale-105 active:scale-95",children:t.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),t.jsxs("div",{className:"h-48 relative overflow-hidden bg-slate-100",children:[y?t.jsx("img",{src:y,alt:f?.altText??e.title,className:"w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"}):t.jsx("div",{className:"flex h-full items-center justify-center px-4 text-center text-xs font-medium text-slate-500",children:"Media preview unavailable"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/15 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100 pointer-events-none"})]}),t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-2",children:[t.jsx("h3",{className:"font-semibold text-secondary transition-transform duration-300 group-hover:-translate-y-0.5",children:e.title}),t.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-gray-900 transition-colors",children:v})]}),t.jsx("p",{className:"text-gray-500 text-xs mb-3 transition-colors duration-300 group-hover:text-gray-600 line-clamp-2",children:N}),t.jsxs("div",{className:"flex flex-wrap gap-2 transition-transform duration-300 group-hover:-translate-y-0.5",children:[t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${C()}`,children:j}),l&&t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${C()}`,children:l}),n&&n!==l&&t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${C()}`,children:n})]}),i&&t.jsxs("div",{className:"mt-5 flex items-center justify-between border-t border-[#E2E8F0] pt-4",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-[11px] font-medium text-[#94A3B8] uppercase tracking-wide",children:"Availability"}),t.jsx("span",{className:"text-[12px] font-semibold text-[#0F172A]",children:m})]}),t.jsx("button",{type:"button",role:"switch","aria-checked":c,"aria-label":c?"Disable availability":"Enable availability",onClick:p=>{p.preventDefault(),p.stopPropagation(),o?.()},className:`relative inline-flex h-[20px] w-[44px] items-center rounded-full transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-secondary ${c?"bg-[#43CC88]":"bg-[#CBD5E1]"}`,children:t.jsx("span",{className:`absolute left-[2px] top-1/2 h-[16px] w-[16px] -translate-y-1/2 rounded-full bg-white shadow transition-transform duration-200 ease-out ${c?"translate-x-[24px]":"translate-x-0"}`})})]})]})]})}function O(e){if(!Array.isArray(e)||e.length===0)return;const a=[...e].sort((i,x)=>{const o=typeof i.sortOrder=="number"?i.sortOrder:Number.MAX_SAFE_INTEGER,c=typeof x.sortOrder=="number"?x.sortOrder:Number.MAX_SAFE_INTEGER;return o-c});return a.find(i=>i.mediaType==="image")??a[0]}function B(e){if(e==null||e==="")return"Price on request";const a=typeof e=="string"?Number(e):e;return Number.isNaN(a)?"Price on request":`₦ ${a.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function b(e){return e?e.split("_").join(" ").split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ").trim():""}function R(e){const a=e.description?.trim();return a||(e.location?e.location:Array.isArray(e.amenities)&&e.amenities.length>0?`Amenities: ${e.amenities.slice(0,3).map(b).join(", ")}`:"No description provided")}const T=["bg-blue-100 text-blue-600","bg-green-100 text-green-600","bg-amber-100 text-amber-600","bg-purple-100 text-purple-600","bg-teal-100 text-teal-600","bg-indigo-100 text-indigo-600","bg-slate-100 text-slate-600","bg-cyan-100 text-cyan-600"];function C(){if(T.length===0)return"bg-gray-100 text-gray-600";const e=Math.floor(Math.random()*T.length);return T[e]}const z=I.injectEndpoints({endpoints:e=>({getAgentPropertyListings:e.query({query:()=>({url:"/api/v1/properties-listing/agent/listings",method:"GET"}),providesTags:["Property"]}),createPropertyListing:e.mutation({query:a=>({url:"/api/v1/properties-listing/agent",method:"POST",body:a}),invalidatesTags:["Property"]})})}),{useGetAgentPropertyListingsQuery:G}=z,M=["Felis sed amet eget aliquam cursus placerat. Risus morbi erat sed curabitur euismod a odio magna condimentum.","Mauris luctus dictum sapien, quis iaculis mauris interdum vitae. Donec efficitur tellus eu odio congue rhoncus.","Etiam sit amet nunc nec ex sollicitudin viverra. Integer pretium arcu quis lorem congue condimentum."],U=D.slice(0,9).map((e,a)=>({id:e.id,title:e.title,price:e.price,image:e.img,description:M[a%M.length],tags:e.tags,category:e.category,condition:e.condition,type:e.type,available:!0})),g=e=>e?.trim().toLowerCase()??"";function K(){const[e,a]=u.useState(U),[i,x]=u.useState("all"),[o,c]=u.useState("all"),[m,f]=u.useState(""),{data:y,isLoading:v,isError:j}=G(),l=y?.data??[],n=l.length>0,N=u.useMemo(()=>n?["all",...Array.from(new Set(l.map(r=>r.propertyCategory).filter(Boolean)))]:["all",...new Set(e.map(r=>r.category))],[l,e,n]);console.log(N);const p=u.useMemo(()=>n?["all",...Array.from(new Set(l.map(r=>r.propertyType).filter(Boolean)))]:["all",...new Set(e.map(r=>r.type))],[l,e,n]),S=u.useMemo(()=>{if(!n)return[];const r=g(m);return l.filter(s=>{const d=i==="all"||s.propertyCategory===i,L=o==="all"||s.propertyType===o,A=!r||[s.title,s.location,s.propertyCategory,s.propertyType,s.propertySubType].some(h=>g(h).includes(r))||s.amenities?.some(h=>g(h).includes(r));return d&&L&&A})},[l,i,o,m,n]),w=u.useMemo(()=>{if(n)return[];const r=g(m);return e.filter(s=>{const d=i==="all"||s.category===i,L=o==="all"||s.type===o,A=!r||g(s.title).includes(r)||g(s.category).includes(r)||s.tags.some(h=>g(h).includes(r));return d&&L&&A})},[e,i,o,m,n]),k=r=>{a(s=>s.map(d=>d.id===r?{...d,available:!d.available}:d))};if(v)return t.jsx("p",{className:"py-20 text-center",children:"Loading listings..."});if(j)return t.jsx("p",{className:"py-20 text-center text-red-600",children:"Failed to load listings"});const F=n?S.length===0:w.length===0;return t.jsxs("div",{className:"pb-10",children:[t.jsxs("header",{className:"mb-10 flex flex-col gap-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-[25px] font-semibold text-[#002E62]",children:"My Listing"}),t.jsxs("nav",{className:"text-[13px] flex items-center gap-1",children:[t.jsx(P,{to:"/dashboard/home",className:"hover:underline",children:"Home"}),t.jsx("span",{children:">"}),t.jsx("span",{className:"text-primary",children:"My Listing"})]})]}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[t.jsx(E,{value:i,onChange:x}),t.jsx(E,{value:o,onChange:c,options:p.map(r=>({label:r==="all"?"Type (All)":V(r),value:r}))}),t.jsx($,{type:"search",placeholder:"Search listings...",value:m,onChange:r=>f(r.target.value)})]})]}),F?t.jsx("div",{className:"rounded-xl border border-dashed p-16 text-center text-gray-500",children:"No listings match your filters."}):t.jsx("div",{className:"grid gap-7 sm:grid-cols-2 xl:grid-cols-4",children:n?S.map(r=>t.jsx(q,{property:r,showAvailabilityToggle:!0},r.id)):w.map(r=>t.jsx(_,{property:{id:r.id,name:r.title,price:H(r.price),description:r.description,category:r.category,image:r.image,subCategory:r.category},available:r.available,showAvailabilityToggle:!0,onToggleAvailability:()=>k(r.id)},r.id))})]})}function H(e){return`₦ ${e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function V(e){return e.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}export{K as default};
